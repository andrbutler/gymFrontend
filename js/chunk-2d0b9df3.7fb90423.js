(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b9df3"],{3594:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card",attrs:{id:"progress"}},[s("div",{staticClass:"card-content"},[s("div",{staticClass:"content columns"},[e.lastWeek.loading?e._e():s("div",{staticClass:"card column is-half",attrs:{id:"last-week"}},[s("p",{staticClass:"card-header-title"},[e._v("Last Week")]),s("p",[e._v(e._s(this.lastWeek.date.toDateString()))]),s("b-field",{attrs:{label:"Calories"}},[s("b-input",{attrs:{placeholder:"calories",type:"number",min:"0"},nativeOn:{input:function(t){return e.validateCal(t.target.validity.valid,e.lastWeek)}},model:{value:e.lastWeek.cal,callback:function(t){e.$set(e.lastWeek,"cal",t)},expression:"lastWeek.cal"}})],1),s("b-field",{attrs:{label:"Weight"}},[s("b-input",{attrs:{placeholder:"weight",type:"number",min:"0"},nativeOn:{input:function(t){return e.validateWeight(t.target.validity.valid,e.lastWeek)}},model:{value:e.lastWeek.weight,callback:function(t){e.$set(e.lastWeek,"weight",t)},expression:"lastWeek.weight"}})],1),s("b-button",{staticClass:"is-success is-light",attrs:{disabled:!e.lastWeek.valid},on:{click:function(t){return e.saveProgress(e.lastWeek)}}},[e._v("Save")])],1),s("b-skeleton",{attrs:{size:"is-large",active:e.lastWeek.loading,count:2}}),e.currentWeek.loading?e._e():s("div",{staticClass:"card column is-half",attrs:{id:"current-week"}},[s("p",{staticClass:"card-header-title"},[e._v("This Week")]),s("p",[e._v(e._s(this.currentWeek.date.toDateString()))]),s("b-field",{attrs:{label:"Calories"}},[s("b-input",{attrs:{placeholder:"calories",type:"number",min:"0"},nativeOn:{input:function(t){return e.validateCal(t.target.validity.valid,e.currentWeek)}},model:{value:e.currentWeek.cal,callback:function(t){e.$set(e.currentWeek,"cal",t)},expression:"currentWeek.cal"}})],1),s("b-field",{attrs:{label:"Weight"}},[s("b-input",{attrs:{placeholder:"weight",type:"number",min:"0"},nativeOn:{input:function(t){return e.validateWeight(t.target.validity.valid,e.currentWeek)}},model:{value:e.currentWeek.weight,callback:function(t){e.$set(e.currentWeek,"weight",t)},expression:"currentWeek.weight"}})],1),s("b-button",{staticClass:"is-success is-light",attrs:{disabled:!e.currentWeek.valid},on:{click:function(t){return e.saveProgress(e.currentWeek)}}},[e._v("Save")])],1),s("b-skeleton",{attrs:{size:"is-large",active:e.currentWeek.loading,count:2}})],1),e.$store.state.signedInUser.progress.loading?e._e():s("b-table",{attrs:{data:e.progress,columns:e.columns}}),s("b-skeleton",{attrs:{size:"is-large",active:e.$store.state.signedInUser.progress.loading,count:2}})],1)])},i=[],r=s("b85c"),n={data:function(){return{currentWeek:{id:null,date:null,cal:null,calValid:!1,weight:null,weightValid:!1,isNew:!0,loading:!1,valid:!1},lastWeek:{id:null,date:null,cal:null,calValid:!1,weight:null,weightValid:!1,isNew:!0,loading:!1,valid:!1},progress:this.$store.state.signedInUser.progress.data,columns:[{field:"week",label:"week",searchable:!0,sortable:!0},{field:"weight",label:"weight",sortable:!0},{field:"weeklyCalories",label:"calories",sortable:!0}]}},created:function(){this.getDays()},methods:{validateWeek:function(e){e.weightValid&&e.calValid?e.valid=!0:e.valid=!1},validateWeight:function(e,t){t.weightValid=e,this.validateWeek(t)},validateCal:function(e,t){t.calValid=e,this.validateWeek(t)},getDays:function(){var e=this.$dayjs();this.currentWeek.date=e.day(0).toDate(),this.lastWeek.date=e.day(0).subtract(1,"week").toDate(),this.currentWeek.date.setHours(12),this.lastWeek.date.setHours(12),this.mapProgress(this.currentWeek),this.mapProgress(this.lastWeek)},mapProgress:function(e){var t,s=Object(r["a"])(this.progress);try{for(s.s();!(t=s.n()).done;){var a=t.value,i=this.$dayjs(a.week).toDate(0);e.date.toDateString()===i.toDateString()&&(e.id=a.progressId,e.cal=a.weeklyCalories,e.weight=a.weight,e.isNew=!1,e.calValid=!0,e.weightValid=!0,e.valid=!0)}}catch(n){s.e(n)}finally{s.f()}},saveProgress:function(e){var t=this;if(e.loading=!0,e.isNew){var s=new Date(e.date);s.setHours(12);var a={weeklyCalories:e.cal,week:s.toISOString(),weight:e.weight,userId:this.$store.state.signedInUser.userId};this.$store.dispatch("setLoading",{phase:"setLoading",type:"signedInUserProgress"}),this.axios.post("/progress/new",a,{headers:{Authorization:"Bearer "+this.$store.state.authToken}}).then((function(s){console.log(s),t.axios.get("/progress/all/"+t.$store.state.signedInUser.userId,{headers:{Authorization:"Bearer "+t.$store.state.authToken}}).then((function(s){t.$store.dispatch("fetchSignedInUserProgress",s.data),t.$store.dispatch("setLoading",{phase:"setLoaded",type:"signedInUserProgress"}),t.progress=t.$store.state.signedInUser.progress.data,t.mapProgress(e),e.loading=!1}),(function(s){t.$buefy.dialog.alert(s.response.data.message),t.$store.dispatch("setLoading",{phase:"setLoaded",type:"signedInUserProgress"}),e.loading=!1}))}),(function(s){t.$buefy.dialog.alert(s.response.data.message),t.$store.dispatch("setLoading",{phase:"setLoaded",type:"signedInUserProgress"}),e.loading=!1}))}else{var i={progressId:e.id,weeklyCalories:e.cal,weight:e.weight,userId:this.$store.state.signedInUser.userId},r={id:e.id,update:i};this.$store.dispatch("setLoading",{phase:"setLoading",type:"signedInUserProgress"}),this.axios.post("/progress/update/"+e.id,i,{headers:{Authorization:"Bearer "+this.$store.state.authToken}}).then((function(s){t.$store.dispatch("updateSignedInUserProgress",r),t.$store.dispatch("setLoading",{phase:"setLoaded",type:"signedInUserProgress"}),console.log(s),t.progress=t.$store.state.signedInUser.progress.data,t.mapProgress(e),e.loading=!1}),(function(s){t.$buefy.dialog.alert(s.response.data.message),t.$store.dispatch("setLoading",{phase:"setLoaded",type:"signedInUserProgress"}),e.loading=!1}))}}}},l=n,o=s("2877"),d=Object(o["a"])(l,a,i,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d0b9df3.7fb90423.js.map